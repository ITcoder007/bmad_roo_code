# 日志和监控

## 1. 日志配置

- **Logback**：使用Logback作为日志框架
- **日志级别**：根据环境配置不同的日志级别
- **日志格式**：统一的日志格式，包含时间戳、日志级别、类名、线程名和日志消息
- **日志配置示例**：
  ```xml
  <configuration>
      <property name="LOG_PATH" value="logs"/>
      <property name="LOG_PATTERN" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"/>
      
      <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
          <encoder>
              <pattern>${LOG_PATTERN}</pattern>
          </encoder>
      </appender>
      
      <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
          <file>${LOG_PATH}/certificate-management.log</file>
          <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
              <fileNamePattern>${LOG_PATH}/certificate-management.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
              <maxFileSize>10MB</maxFileSize>
              <maxHistory>30</maxHistory>
              <totalSizeCap>1GB</totalSizeCap>
          </rollingPolicy>
          <encoder>
              <pattern>${LOG_PATTERN}</pattern>
          </encoder>
      </appender>
      
      <root level="INFO">
          <appender-ref ref="CONSOLE"/>
          <appender-ref ref="FILE"/>
      </root>
      
      <logger name="com.example.certificate" level="DEBUG"/>
  </configuration>
  ```

## 2. 监控配置

- **Spring Boot Actuator**：使用Spring Boot Actuator提供应用监控端点
- **健康检查**：配置健康检查端点，监控应用状态
- **指标收集**：收集应用性能指标，如内存使用、GC情况、HTTP请求等
- **监控配置示例**：
  ```yaml
  management:
    endpoints:
      web:
        exposure:
          include: health,info,metrics,prometheus
    endpoint:
      health:
        show-details: always
    metrics:
      export:
        prometheus:
          enabled: true
    health:
      db:
        enabled: true
      diskspace:
        enabled: true
  ```

## 3. 告警配置

- **自定义健康指标**：实现自定义健康指标，监控证书状态和预警发送情况
- **告警规则**：配置告警规则，当特定条件满足时发送告警
- **告警渠道**：支持邮件、短信等多种告警渠道