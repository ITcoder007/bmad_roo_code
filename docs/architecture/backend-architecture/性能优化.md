# 性能优化

## 1. 缓存策略

- **Spring Cache抽象**：使用Spring Cache抽象实现缓存
- **缓存配置**：
  ```java
  @Configuration
  @EnableCaching
  public class CacheConfig {
      
      @Bean
      public CacheManager cacheManager() {
          SimpleCacheManager cacheManager = new SimpleCacheManager();
          cacheManager.setCaches(Arrays.asList(
              new ConcurrentMapCache("certificates"),
              new ConcurrentMapCache("monitoringLogs"),
              new ConcurrentMapCache("systemStatus")
          ));
          return cacheManager;
      }
  }
  ```
- **缓存使用**：
  ```java
  @Service
  public class CertificateServiceImpl implements CertificateService {
      
      @Cacheable(value = "certificates", key = "#id")
      public Certificate findById(Long id) {
          // 查询逻辑...
      }
      
      @CacheEvict(value = "certificates", key = "#certificate.id")
      public Certificate update(Certificate certificate) {
          // 更新逻辑...
      }
      
      @CacheEvict(value = "certificates", key = "#id")
      public void deleteById(Long id) {
          // 删除逻辑...
      }
  }
  ```

## 2. 数据库优化

- **连接池配置**：使用HikariCP高性能连接池
- **索引优化**：为常用查询字段创建索引
- **查询优化**：使用MyBatis的动态SQL和分页查询
- **批量操作**：使用批量插入和更新提高效率

## 3. 异步处理

- **@Async注解**：使用Spring的@Async注解实现异步方法调用
- **异步配置**：
  ```java
  @Configuration
  @EnableAsync
  public class AsyncConfig implements AsyncConfigurer {
      
      @Override
      public Executor getAsyncExecutor() {
          ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
          executor.setCorePoolSize(5);
          executor.setMaxPoolSize(10);
          executor.setQueueCapacity(25);
          executor.setThreadNamePrefix("Async-Executor-");
          executor.initialize();
          return executor;
      }
      
      @Override
      public AsyncUncaughtExceptionHandler getAsyncUncaughtExceptionHandler() {
          return new CustomAsyncExceptionHandler();
      }
  }
  ```
- **异步使用**：
  ```java
  @Service
  public class AlertServiceImpl implements AlertService {
      
      @Async
      public CompletableFuture<EmailResult> sendExpiryAlertEmail(Certificate certificate, int daysUntilExpiry, String recipientEmail) {
          // 发送邮件逻辑...
          return CompletableFuture.completedFuture(emailResult);
      }
      
      @Async
      public CompletableFuture<SmsResult> sendExpiryAlertSms(Certificate certificate, int daysUntilExpiry, String recipientPhone) {
          // 发送短信逻辑...
          return CompletableFuture.completedFuture(smsResult);
      }
  }
  ```
